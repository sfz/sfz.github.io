<!DOCTYPE html>
<html
	lang="en"
	data-bs-theme="auto"
>
	<head>
		<meta charset="utf-8">
		<meta name="author" content="Karoryfer Samples and SFZ Format Team">
		<meta name="web-author" content="redtide and SFZ Format Team">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
		<title>Subtractive synthesizers - SFZ Format</title>
	
		<script src="../../assets/js/color-modes.js"></script>
		<link href="../../atom.xml" rel="alternate" title="News" type="application/atom+xml" />

		
		<!-- realfavicongenerator.net -->
		<link rel="apple-touch-icon" sizes="152x152" href="../../assets/ico/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="../../assets/ico/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="../../assets/ico/favicon-16x16.png">
		<link rel="manifest" href="../../assets/ico/site.webmanifest">
		<link rel="mask-icon" href="../../assets/ico/safari-pinned-tab.svg" color="#5bbad5">
		<link rel="shortcut icon" href="../../assets/ico/favicon.ico">
		<meta name="msapplication-TileColor" content="#da532c">
		<meta name="msapplication-config" content="../../assets/ico/browserconfig.xml">
		<meta name="theme-color" content="#ffffff">
		<link href="../../assets/css/style.min.css" rel="stylesheet" media="screen">
		<link href="../../../../assets/css/fontawesome.min.css" rel="stylesheet">
		<link href="../../../../assets/css/brands.min.css" rel="stylesheet">
		<link href="../../../../assets/css/solid.min.css" rel="stylesheet">
		<link href="../../../../assets/css/v4-font-face.min.css" rel="stylesheet">
		<link href="../../../../assets/css/bootstrap-table.min.css" rel="stylesheet">		<link
			rel="stylesheet"
			href="../../assets/css/github.min.css"
			disabled="disabled"
			id="hljs_light"
		/>
		<link
			rel="stylesheet"
			href="../../assets/css/github-dark-dimmed.min.css"
			disabled="disabled"
			id="hljs_dark"
		/>
	</head>
	<body>
		<button onclick="topFunction()" id="scrollButton" title="Go to top">Top</button>
		<div class="container">			<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  		<!--!
				Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License
				https://fontawesome.com/license/free
				(Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
				Copyright 2023 Fonticons, Inc.
			-->
				<symbol id="sun" viewBox="0 0 512 512">
					<path d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z" />
				</symbol>
				<symbol id="moon" viewBox="0 0 384 512">
					<path d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z" />
				</symbol>
				<symbol id="circle-half-stroke" viewBox="0 0 512 512">
					<path d="M448 256c0-106-86-192-192-192V448c106 0 192-86 192-192zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z" />
				</symbol>
				<symbol id="check" viewBox="0 0 448 512">
					<path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z" />
				</symbol>
			</svg>
			<nav
				class="navbar navbar-expand-lg bg-dark text-bg-dark"
				data-bs-theme="dark"
			>
				<div class="container-fluid">

					<button
						class="navbar-toggler"
						type="button"
						data-bs-toggle="collapse"
						data-bs-target="#navbarContent"
						aria-controls="navbarContent"
						aria-expanded="false"
						aria-label="Toggle navigation"
					>
						<span class="navbar-toggler-icon"></span>
					</button>

					<a
						class="navbar-brand"
						href="../.."
						>
							<img
								alt="Logo image"
								src="../../assets/img/logo.svg"
							/>
					</a>

					<div class="collapse navbar-collapse" id="navbarContent">
						<ul class="navbar-nav mt-2 mt-lg-0">
							<li class="nav-item dropdown">
								<a
									class="nav-link dropdown-toggle"
									href="#"
									id="navbarSyntax"
									role="button"
									data-bs-toggle="dropdown"
									aria-expanded="false"
									aria-haspopup="true"
								>
									Syntax
								</a>
								<ul
									class="dropdown-menu"
									aria-labelledby="navbarSyntax"
								>
									<li>
										<a class="dropdown-item"
											href="/headers/"
										>
											Headers
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/opcodes/"
										>
											Opcodes
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/modulations/"
										>
											Modulations
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/modulations/envelope_generators"
										>
											Envelope Generators
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/modulations/lfo"
										>
											LFO
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/extensions/midi_ccs"
										>
											Extended MIDI CCs
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/misc/categories"
										>
											Types & Categories
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/versions"
										>
											Versions
										</a>
									</li>
								</ul>
							</li>
							<li class="nav-item dropdown">
								<a
									class="nav-link dropdown-toggle"
									href="#"
									id="navbarSoftware"
									role="button"
									data-bs-toggle="dropdown"
									aria-expanded="false"
									aria-haspopup="true"
								>
									Software
								</a>
								<ul
									class="dropdown-menu"
									aria-labelledby="navbarSoftware"
								>
									<li>
										<a class="dropdown-item"
											href="/software/players"
										>
											Players
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/software/tools"
										>
											Tools
										</a>
									</li>
								</ul>
							</li>
							<li class="nav-item dropdown">
								<a
									class="nav-link dropdown-toggle"
									href="#"
									id="navbarTutorials"
									role="button"
									data-bs-toggle="dropdown"
									aria-expanded="false"
									aria-haspopup="true"
								>
									Tutorials
								</a>
								<ul
									class="dropdown-menu"
									aria-labelledby="navbarTutorials"
								>
									<li>
										<a class="dropdown-item"
											href="/tutorials/basics"
										>
											Basics
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/tutorials/basic_sfz_file"
										>
											Basic / Template
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/sustained_note_basics"
										>
											Sustained Note Basics
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/vibrato"
										>
											Vibrato
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/legato"
										>
											Legato
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/unison"
										>
											Unison
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/range_extension"
										>
											Range Extension
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/modular_instruments"
										>
											Modular Instruments
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/subtractive_synths"
										>
											Subtractive Synthesizers
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/strum"
										>
											Strumming
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/tutorials/drum_basics"
										>
											Drum & Round Robin Basics
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/cymbal_muting"
										>
											Cymbal Muting
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/epic_drums"
										>
											Epic Drums
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/brush_stirs"
										>
											Brush Stirs
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/tutorials/envelope_generators"
										>
											Envelope Generators
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/sfz1_modulations"
										>
											SFZ 1 Modulations
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/sfz2_modulations"
										>
											SFZ 2 Modulations
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/lfo"
										>
											Pitch LFO Examples
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/tutorials/videos"
										>
											Video Tutorials
										</a>
									</li>
								</ul>
							</li>
							<li class="nav-item">
								<a
									class="nav-link"
									href="https://sfzinstruments.github.io"
								>
									Instruments
								</a>
							</li>
							<li class="nav-item">
								<a
									class="nav-link"
									href="/news"
								>
									News
								</a>
							</li>
						</ul>
						<ul class="navbar-nav ms-auto">
							<li class="nav-item">
									<a
										href="#"
										class="nav-link"
										data-bs-toggle="modal"
										data-bs-target="#mkdocs_search_modal">
											<i class="fa fa-search"></i> Search
									</a>
							</li>
							<li class="nav-item dropdown">
								<button
									class="btn btn-link nav-link py-2 px-0 px-lg-2 dropdown-toggle d-flex align-items-center"
									id="bd-theme"
									type="button"
									aria-expanded="false"
									data-bs-toggle="dropdown"
									data-bs-display="static"
									aria-label="Toggle theme (auto)">
									<svg class="bi my-1 theme-icon-active"><use href="#circle-half-stroke"></use></svg>
									<span class="d-lg-none ms-2" id="bd-theme-text">Toggle theme</span>
								</button>
								<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
									<li>
										<button
											type="button"
											class="dropdown-item d-flex align-items-center"
											data-bs-theme-value="light"
											aria-pressed="false">
											<svg class="bi me-2 opacity-50 theme-icon"><use href="#sun"></use></svg>
											Light
											<svg class="bi ms-auto d-none"><use href="#check"></use></svg>
										</button>
									</li>
									<li>
										<button
											type="button"
											class="dropdown-item d-flex align-items-center"
											data-bs-theme-value="dark"
											aria-pressed="false">
											<svg class="bi me-2 opacity-50 theme-icon"><use href="#moon"></use></svg>
											Dark
											<svg class="bi ms-auto d-none"><use href="#check"></use></svg>
										</button>
									</li>
									<li>
										<button
											type="button"
											class="dropdown-item d-flex align-items-center active"
											data-bs-theme-value="auto"
											aria-pressed="true">
											<svg class="bi me-2 opacity-50 theme-icon"><use href="#circle-half-stroke"></use></svg>
											Auto
											<svg class="bi ms-auto d-none"><use href="#check"></use></svg>
										</button>
									</li>
								</ul>
							</li>
						</ul>
					</div>
				</div>
			</nav>
			<div class="row mt-4" id="content">
				<div class="col-md-9">
					<article>
						<h1>Subtractive synthesizers</h1><h2 id="introduction">Introduction</h2>
<p>This tutorial describes implementing typical subtractive synthesizer
modulations - filters, envelopes and LFOs - in SFZ. It uses the
Caveman Cosmonaut instrument by Karoryfer Samples as an example. This
does not cover all modulations used in classic hardware subtractive
synths, but it's a start.</p>
<h2 id="basic-amplifier-envelope">Basic amplifier envelope</h2>
<p>Though subtractive synths get their name from having frequencies
subtracted from the sound by filter, the volume envelope is probably
the most fundamental modulation. Here is an <a href="../../opcodes/ampeg_attack/">AHDSR envelope</a> including
<a href="../../headers/control/">‹control›</a> parameter labels and defaults.</p>
<pre><code class="language-sfz">&lt;control&gt;
label_cc100=Attack time
label_cc101=Hold time
label_cc102=Decay time
label_cc103=Sustain level
label_cc104=Release time

set_cc102=63
set_cc103=51
set_cc104=31

&lt;global&gt;
//AHDSR
ampeg_attack=0.002
ampeg_sustain=0
ampeg_release=0.002
ampeg_attack_oncc100=0.5
ampeg_hold_oncc101=1
ampeg_decay_oncc102=5
ampeg_sustain_oncc103=100
ampeg_release_oncc104=2
</code></pre>
<p>An ADSR envelope would simple leave out the <a href="../../opcodes/ampeg_hold/">hold</a> stage control,
leaving the default hold time of zero.</p>
<h2 id="further-envelope-possibilities">Further envelope possibilities</h2>
<p>The above envelope will affect all sounds, as it's set at the global
level. In many classic synths, it's possible to have separate
envelopes modulating the volume of different oscillators, for
example using a shorter envelope to turn a noise oscillator into
a short transient.</p>
<p>If more envelope stages are required, an <a href="../../modulations/envelope_generators/">SFZ2 envelope</a> with an
arbitrary amount of points can be used to modulate amplitude
instead of the SFZ1 envelope above.</p>
<p>In the ARIA SFZ player, amplifier envelope durations are calculated
once on trigger, which means changing envelope parameters other than
sustain and release while a note is playing will not change the sound.
The <a href="../../opcodes/ampeg_dynamic/">ampeg_dynamic</a> opcode could be set to 1 in order to recalculate
envelope parameters every time one of the control parameters receives
a MIDI message, which could be closer to the behavior of most
analog synthesizer hardware.</p>
<p>Caveman Cosmonaut has a more unusual parameter called Env Soften,
which has no effect on some oscillators which have more
high-frequency content, and adds to the release and decay times
of the warmer-sounding oscillators. This is highly unusual, but
can be musically useful for things such as plucks, as the warmer
sounds linger longer. This is similar to the effect of release
or decay on a lowpass filter cutoff, but perhaps a little more
organic. That's set per oscillator, rather than globally, like
this, with CC 18 selecting the oscillator, and CC 106 being the
envelope soften:</p>
<pre><code class="language-sfz">&lt;master&gt;
locc18=11
hicc18=20
ampeg_decay_oncc106=1.25
ampeg_release_oncc106=0.7
#include &quot;mappings/unitra_flutes.sfz&quot;

&lt;master&gt;
locc18=21
hicc18=30
ampeg_decay_oncc106=1
ampeg_release_oncc106=0.4
#include &quot;mappings/unitra_clarinet.sfz&quot;

&lt;master&gt;
locc18=31
hicc18=40
ampeg_decay_oncc106=1.5
ampeg_release_oncc106=0.6
#include &quot;mappings/unitra_trombone.sfz&quot;

&lt;master&gt;
locc18=41
hicc18=50
ampeg_decay_oncc106=0.5
ampeg_release_oncc106=0.2
#include &quot;mappings/unitra_trompette.sfz&quot;

&lt;master&gt;
locc18=51
hicc18=60
ampeg_decay_oncc106=1.25
ampeg_release_oncc106=0.5
#include &quot;mappings/unitra_violin.sfz&quot;

&lt;master&gt;
locc18=61
hicc18=70
#include &quot;mappings/unitra_tremolo.sfz&quot;

&lt;master&gt;
locc18=71
#include &quot;mappings/unitra_all.sfz&quot;
</code></pre>
<h2 id="basic-filter">Basic filter</h2>
<p>The filter in the example instrument is a single <a href="../../opcodes/fil_type/">lowpass</a> filter
with <a href="../../opcodes/cutoff/">cutoff</a> and <a href="../../opcodes/resonance/">resonance</a> controls, adjustable <a href="../../extensions/midi_ccs/">velocity</a> tracking using
<a href="../../opcodes/varNN_mod/">var</a> a two-stage <a href="../../opcodes/fileg_attack/">filter cutoff envelope</a>.</p>
<pre><code class="language-sfz">&lt;control&gt;
label_cc120=Filter cutoff
label_cc121=Resonance
label_cc124=Veltrack
label_cc125=Pluck
label_cc126=Filter attack
label_cc127=Filter decay

set_cc120=127
set_cc127=40

&lt;global&gt;
//Lowpass filter
cutoff=250
cutoff_cc120=9600
fil_keytrack=100
resonance=0
resonance_cc121=18
var01_cutoff=6000 //Velocity track
var01_mod=mult
var01_oncc131=1
var01_oncc124=1
cutoff_cc124=-3000
//Pluck envelope
fileg_depth=0
fileg_depthcc125=8400
fileg_sustain=0
fileg_attack=0
fileg_attackcc126=0.5
fileg_decay=0.001
fileg_decaycc127=2
</code></pre>
<h2 id="filter-keytracking">Filter keytracking</h2>
<p>Making the filter cutoff keytrack is a simple matter of
setting the <a href="../../opcodes/fil_keytrack/">fil_keytrack</a> to 100; however, things get
more complicated if filter keytracking is not desired.
Although fil_keytrack can be set to 0 and the base
filter cutoff will then not keytrack, the filter cutoff
modulation in SFZ is specified in cents, not Hertz. This
means the amount of the cutoff which is modulated will
keytrack, regardless of what fil_keytrack is set to. This
isn't a big issue with most synthesizers, but when trying
to make an adjustable highpass filter for all pieces of
a drum kit except the kick, for example, it can make
things complicated.</p>
<p>Adjusting keytracking for the modulated amount requires
using var and the extended CC 133 (MIDI key number).
Var and extended CCs are already used above for the
velocity tracking on the filter cutoff. The example instrument
has a somewhat convoluted and unusual configuration for
the filter keytracking, where when CC 120 has a very
high value, the cutoff will be slightly above 22.05 kHz
for all keys in the instrument's range, while the cutoff
when CC 120 is at zero has 70% keytracking. This is not
at all standard, and means the base cutoff has moderate
positive keytracking while the cutoff modulation has
negative keytracking.</p>
<pre><code class="language-sfz">//By default, cutoff modulation is measured in cents
//To make the modulation not keytrack, we make a kludge
//Using var
cutoff=250
var02_cutoff=9000
var02_mod=mult
var02_oncc120=1
var02_curvecc120=0
var02_oncc133=1
var02_curvecc133=11
fil_keytrack=70
</code></pre>
<p>At the end of the SFZ file, the <a href="../../headers/curve/">‹curve›</a> is then specified:</p>
<pre><code class="language-sfz">&lt;curve&gt;
curve_index=11
v000=1
v024=1
v084=0.63
v127=0.25
</code></pre>
<h2 id="more-filter-possibilities">More filter possibilities</h2>
<p>It would be easy to have more filter envelope stages; only
attack and decay are used above to keep things simple, as
those parameters are enough to create basic plucks (zero
attack, moderate decay) and 303 style basses (slightly
longer attack, moderate decay).</p>
<p>Using fil2_type and cutoff2 allows two filters in series,
for example a lowpass and highpass filter. Fil_type can
also be used to choose different filter types, perhaps with
<a href="../../opcodes/loccN/">locc/hicc</a>.</p>
<p>Modulating the filter cutoff with LFOs is added below, in the
vibrato section.</p>
<h2 id="vibrato">Vibrato</h2>
<p>Vibrato can affect pitch, volume (for tremolo) and filter cutoff
(for wobble). Here is a typical setup using one <a href="../../modulations/lfo/">LFO</a> to modulate
all three.</p>
<pre><code class="language-sfz">&lt;control&gt;
label_cc111=Vibrato to pitch
label_cc112=Vibrato speed
label_cc113=Vibrato to cutoff
label_cc114=Vibrato to volume
label_cc115=Vibrato delay
label_cc116=Vibrato fade

set_cc112=40

&lt;global&gt;
lfo01_pitch_oncc111=22 //Vibrato LFO
lfo01_freq=0.1
lfo01_freq_oncc112=9.9
lfo01_delay_oncc115=0.500
lfo01_fade_oncc116=0.500
lfo01_volume_oncc114=6
//Wobble
lfo01_cutoff=0
lfo01_cutoff_oncc113=3600
</code></pre>
<h2 id="humanized-vibrato">Humanized vibrato</h2>
<p>Humanization is obviously not a standard feature of synthesizers.
Technically, though, it's not difficult to implement.</p>
<p>The example instrument adds CC 117 for controlling the
amount of randomization
of the vibrato LFOs. This is similar to the humanization
described in the <a href="../vibrato/">vibrato tutorial</a>, but using CC 135 to
generate a true random number for each voice, which
means any unison voices' vibrato will drift out of sync
with those belonging to other voices. This is musically
useful for creating more complex pads, for example. Similar
principles could also be used to emulate analog oscillators'
much more subtle pitch drift.</p>
<pre><code class="language-sfz">&lt;control&gt;
label_cc111=Vibrato to pitch
label_cc112=Vibrato speed
label_cc113=Vibrato to cutoff
label_cc114=Vibrato to volume
label_cc115=Vibrato delay
label_cc116=Vibrato fade
label_cc117=Vibrato humanize

set_cc112=40

&lt;global&gt;
//Vibrato and humanization setup
lfo01_pitch_oncc111=22 //Vibrato LFO
lfo01_freq=0.1
lfo01_freq_oncc112=9.9
lfo01_delay_oncc115=0.500
lfo01_fade_oncc116=0.500
lfo01_volume_oncc114=6
//Wobble
lfo01_cutoff=0
lfo01_cutoff_oncc113=3600

lfo02_wave=1 //Second LFO to make things wobblier
lfo02_phase=0
lfo02_phase_oncc135=1 //Phase randomized
lfo02_freq=0.01 //Basically no movement at very slow speeds, just randomization
lfo02_freq_oncc117=1 //Max rate is not very high, so it doesn't sound too obvious
lfo02_pitch_oncc117=6 //Slight pitch wobbliness
lfo02_freq_lfo01_oncc117=0.5 //Affect the rate of the other LFO for unsteady vibrato
lfo02_freq_lfo01_oncc112=2.5 //Faster when the first LFO is going faster

lfo03_wave=1 //And a third LFO for secondhand complex wobbliness
lfo03_phase=0.4
lfo03_phase_oncc135=0.179 //Different phase response to random than the second LFO
lfo03_freq=0.5
lfo03_freq_oncc117=-0.4
lfo03_freq_lfo2_oncc117=1
lfo03_pitch_oncc117=-4

lfo04_wave=1 //Fourth LFO for slowly changing the oscillator mix
lfo04_phase_oncc135=1
lfo04_freq=0.01
lfo04_freq_oncc135=0.25 //Randomly from almost not moving at all to still pretty slow
lfo04_volume_oncc117=1.5 //Slight volume changes
</code></pre>
<h2 id="unison-and-detune">Unison and detune</h2>
<p>Unison is a simple matter of triggering multiple regions
with one MIDI note. If using a simple sound source such
as a saw oscillators, all regions will sound identical so
the only result will be additional volume. Making the
unison more interesting requires some of: using different
samples for each voice, detuning the voices, and shifting
the phase of the voices.</p>
<p>The example instrument uses many sets of samples from an
analog keyboard, with every key producing a slightly
different timbre, and transposed versions of those sounds
used for unison. The <a href="../../opcodes/pitch_onccN/">detune</a> and width amounts vary for
each of the three oscillators, but here is a simplified
version assuming there is only one oscillator.</p>
<p>Note that although there is a <a href="../../opcodes/width/">width</a> opcodes for
use with stereo samples, in this case the left channel and right are
separate mono samples, so <a href="../../opcodes/pan/">pan</a> is used to spread them
in stereo - not width.</p>
<p>As the samples here are quite long, <a href="../../opcodes/offset_random/">offset_random</a>
is applied globally to effecitvely randomize each voice's phase. With
true single-cycle waveforms, the max offset would have to be set to
match each voice's max sample length.</p>
<pre><code class="language-sfz">&lt;control&gt;
label_cc25=Unison
label_cc26=Width
label_cc27=Detune

set_cc26=63
set_cc27=63

&lt;global&gt;
//Randomizing the start points of the samples to randomize phase
offset_random=1000

//Center voice
&lt;master&gt;
#include &quot;sample_map_basic.sfz&quot;

//Left voice
&lt;region&gt;
amplitude_cc25=100
amplitude_cc25=100
locc25=1
pan_cc26=-100
tune_cc27=-33
#include &quot;sample_map_transposed_1.sfz&quot;

//Right voice
&lt;region&gt;
amplitude_cc25=100
locc25=1
pan_cc26=100
tune_cc27=33
amplitude_cc25=100
#include &quot;sample_map_transposed_2.sfz&quot;
</code></pre>
<h2 id="more-complex-detune">More complex detune</h2>
<p>Another highly unsual feature of Caveman Cosmonaut, though, is
that the detune doesn't have to be fixed. There are additional
detune controls which detune the additional voices more at the
start of the note, and then drift towards a common pitch over
time, using <a href="../../opcodes/pitcheg_attack/">pitch envelopes</a>. This is definitely not part of
any typical hardware analog synthesizer's feature set, but it
does have something in common with the way real world choirs
or instrumental ensembles find a commmon pitch.</p>
<pre><code class="language-sfz">&lt;control&gt;
label_cc25=Unison
label_cc26=Width
label_cc27=Detune
label_cc28=Extra detune amt
label_cc29=Extra detune time

set_cc26=63
set_cc27=63
set_cc29=16

&lt;global&gt;
//Randomizing the start points of the samples to randomize phase
offset_random=1000

//Pitch envelope defaults for the fancy detune
pitcheg_sustain=0
pitcheg_decay_shape=-2

//Center voice
&lt;master&gt;
#include &quot;sample_map_basic.sfz&quot;

//Left voice
&lt;region&gt;
amplitude_cc25=100
locc25=1
pan_cc26=-100
tune_cc27=-33
pitcheg_depth_oncc28=-150
pitcheg_decay_oncc29=5
#include &quot;sample_map_transposed_1.sfz&quot;

//Right voice
&lt;region&gt;
amplitude_cc25=100
locc25=1
pan_cc26=100
tune_cc27=33
pitcheg_depth_oncc28=150
pitcheg_decay_oncc29=5
#include &quot;sample_map_transposed_2.sfz&quot;
</code></pre>
<h2 id="waveform-selection-and-oscillator-mixing">Waveform selection and oscillator mixing</h2>
<p>This is just locc/hicc for selection, and <a href="../../opcodes/amplitude/">amplitude</a> for volume
controls.</p>
<h2 id="mono-mode-and-portamento">Mono mode and portamento</h2>
<p>This is implemented similarly to any non-synth - see our <a href="../legato/">legato tutorial</a>.</p>
<h2 id="putting-it-all-together">Putting it all together</h2>
<p>This is the main file for the example instrument. The unison and detune
settings, along with oscillator selection and mixing, are inside SFZ files
added via the <a href="../../opcodes/include/">#include</a> directives.</p>
<pre><code class="language-sfz">&lt;control&gt;
label_cc15=Bass Osc Vol
label_cc16=Bass Osc Sel
label_cc17=Osc 1 Vol
label_cc18=Osc 1 Sel
label_cc19=Osc 2 Vol
label_cc20=Osc 2 Sel
label_cc21=Osc 3 Vol
label_cc22=Osc 3 Sel
label_cc25=Unison
label_cc26=Width
label_cc27=Detune
label_cc28=Extra detune amt
label_cc29=Extra detune time
label_cc100=Attack time
label_cc101=Hold time
label_cc102=Decay time
label_cc103=Sustain level
label_cc104=Release time
label_cc106=Env soften
label_cc108=Legato switch
label_cc109=Porta time
label_cc111=Vibrato to pitch
label_cc112=Vibrato speed
label_cc113=Vibrato to cutoff
label_cc114=Vibrato to volume
label_cc115=Vibrato delay
label_cc116=Vibrato fade
label_cc117=Unsteadiness
label_cc120=Filter cutoff
label_cc121=Resonance
label_cc124=Veltrack
label_cc125=Pluck
label_cc126=Filter attack
label_cc127=Filter decay

set_cc15=100
set_cc16=15
set_cc17=127
set_cc18=63
set_cc19=100
set_cc20=15
set_cc21=100
set_cc22=44
set_cc26=63
set_cc27=63
set_cc29=16
set_cc102=63
set_cc103=51
set_cc104=31
set_cc109=31
set_cc112=40
set_cc120=127
set_cc127=40

&lt;global&gt;
bend_down=-2400
bend_up=2400
off_mode=normal
loop_mode=continuous
offset=10000
offset_random=1000

//AHDSR
ampeg_attack=0.002
ampeg_sustain=0
ampeg_release=0.002
ampeg_attack_oncc100=0.5
ampeg_hold_oncc101=1
ampeg_decay_oncc102=5
ampeg_sustain_oncc103=100
ampeg_release_oncc104=2
//Decay and release are affected by the soften parameter also
//This is set separately for each oscillator

//Filter
//Lowpass filter
//By default, cutoff modulation is measured in cents
//To make the modulation not keytrack, we make a kludge
//Using var
cutoff=250
var02_cutoff=9000
var02_mod=mult
var02_oncc120=1
var02_curvecc120=0
var02_oncc133=1
var02_curvecc133=11
fil_keytrack=70
resonance=0
resonance_cc121=18
var01_cutoff=6000 //Velocity track
var01_mod=mult
var01_oncc131=1
var01_oncc124=1
cutoff_cc124=-3000
//Pluck envelope
fileg_depth=0
fileg_depthcc125=8400
fileg_sustain=0
fileg_attack=0
fileg_attackcc126=0.5
fileg_decay=0.001
fileg_decaycc127=2

//Vibrato and humanization setup
lfo01_pitch_oncc111=22 //Vibrato LFO
lfo01_freq=0.1
lfo01_freq_oncc112=9.9
lfo01_delay_oncc115=0.500
lfo01_fade_oncc116=0.500
lfo01_volume_oncc114=6
//Wobble
lfo01_cutoff=0
lfo01_cutoff_oncc113=3600

lfo02_wave=1 //Second LFO to make things wobblier
lfo02_phase=0
lfo02_phase_oncc135=1 //Phase randomized
lfo02_freq=0.01 //Basically no movement at very slow speeds, just randomization
lfo02_freq_oncc117=1 //Max rate is not very high, so it doesn't sound too obvious
lfo02_pitch_oncc117=6 //Slight pitch wobbliness
lfo02_freq_lfo01_oncc117=0.5 //Affect the rate of the other LFO for unsteady vibrato
lfo02_freq_lfo01_oncc112=2.5 //Faster when the first LFO is going faster

lfo03_wave=1 //And a third LFO for secondhand complex wobbliness
lfo03_phase=0.4
lfo03_phase_oncc135=0.179 //Different phase response to random than the second LFO
lfo03_freq=0.5
lfo03_freq_oncc117=-0.4
lfo03_freq_lfo2_oncc117=1
lfo03_pitch_oncc117=-4

lfo04_wave=1 //Fourth LFO for slowly changing the oscillator mix
lfo04_phase_oncc135=1
lfo04_freq=0.01
lfo04_freq_oncc135=0.25 //Randomly from almost not moving at all to still pretty slow
lfo04_volume_oncc117=1.5 //Slight volume changes

//Some defaults for the fancy detune stuff
pitcheg_sustain=0
pitcheg_decay_shape=-2

//And here come the oscillator mappings
//First polyphonic mode

#include &quot;mappings/poly_map.sfz&quot;

#include &quot;mappings/mono_first_map.sfz&quot;

#include &quot;mappings/mono_legato_map.sfz&quot;

&lt;curve&gt;
curve_index=11
v000=1
v024=1
v084=0.63
v127=0.25
</code></pre>
					</article>
				</div>
				<div class="col-md-3">
					<aside>
						<div class="card mb-3">
							<div class="card-header bg-dark text-bg-dark">
								<i class="fa fa-eye"
									aria-hidden="true"></i>
								Follow us
							</div>
							<div class="card-body" style="padding: 0.5rem">
								<ul class="nav nav-pills flex-column">
									<li class="nav-item">
										<a class="nav-link" href="https://github.com/sfz/"
											title="GitHub Organization" style="padding: 0.35rem 0.25rem">
										<i class="fab fa-github fa-fw"
										aria-hidden="true"></i>
										GitHub Organization</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="/atom.xml"
											title="News Atom Feed" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-rss fa-fw"
										aria-hidden="true"></i>
										News Atom Feed</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://discord.gg/t7nrZ6d"
											title="Discord Chat" style="padding: 0.35rem 0.25rem">
										<i class="fab fa-discord fa-fw"
										aria-hidden="true"></i>
										Discord Chat</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://kiwiirc.com/nextclient/#irc://irc.libera.chat:+6697/#sfzformat"
											title="Internet Relay Chat" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-hashtag fa-fw"
										aria-hidden="true"></i>
										IRC</a>
									</li>
								</ul>
							</div>
						</div>
						<div class="card mb-3">
							<div class="card-header bg-dark text-bg-dark">
								<i class="fa fa-link"
									aria-hidden="true"></i>
								Quick links
							</div>
							<div class="card-body" style="padding: 0.5rem">
								<ul class="nav nav-pills flex-column">
									<li class="nav-item">
										<a class="nav-link" href="/legacy"
											title="Old rgc:audio SFZ page" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-book fa-fw"
										aria-hidden="true"></i>
										Old rgc:audio SFZ page</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="http://www.drealm.info/sfz/"
											title="Peter L. Jones' SFZ page" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-book fa-fw"
										aria-hidden="true"></i>
										Peter L. Jones' SFZ page</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://www.kvraudio.com/forum/viewtopic.php?f=42&t=508861"
											title="KVR Forum SFZ post" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-users fa-fw"
										aria-hidden="true"></i>
										KVR Forum SFZ post</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://www.plogue.com/plgfrms/viewforum.php?f=14"
											title="Plogue Forum" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-users fa-fw"
										aria-hidden="true"></i>
										Plogue Forum</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://github.com/sfz/tests/"
											title="rgc:audio SFZ test suite" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-download fa-fw"
										aria-hidden="true"></i>
										rgc:audio SFZ test suite</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://github.com/sfz/opcode-suggestions/"
											title="Opcode suggestions" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-lightbulb fa-fw"
										aria-hidden="true"></i>
										Opcode suggestions</a>
									</li>
								</ul>
							</div>
						</div>
						
					</aside>
				</div>
			</div>			<hr>
			<footer>
				<p style="text-align:left">
					<span style="float:right">
						This site is open source.
						<a href="https://github.com/sfz/sfz.github.io/edit/source/docs/tutorials/subtractive_synths.md">
						Improve this page</a>
					</span>
				</p>
			</footer>
		</div>		<script>
			var base_url	= "../..",
					shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
		</script>
		<script src="../../assets/js/jquery.min.js"></script>
		<script async defer src="../../assets/js/popper.min.js"></script>
		<script async defer src="../../assets/js/bootstrap.min.js"></script>
		<script async defer src="../../assets/js/anchor.min.js"></script>
		<script async defer src="../../assets/js/base.min.js"></script>
		<script async defer src="../../assets/js/scroll-to-top.min.js"></script>
		<script async defer src="../../../../assets/js/index.bundle.min.js"></script>
		<script async defer src="../../../../assets/js/bootstrap-table.min.js"></script>
		<script async defer src="../../../../assets/js/mermaid.min.js"></script>
		<script async defer src="../../../../search/main.js"></script>		<script
			type="text/javascript"
			src="../../assets/js/highlight.min.js">
		</script>
		<script
			type="text/javascript"
			src="../../assets/js/bash.min.js">
		</script>
		<script
			type="text/javascript"
			src="../../assets/js/cpp.min.js">
		</script>
		<script
			type="text/javascript"
			src="../../assets/js/sfz.min.js">
		</script>
		<script>hljs.highlightAll();</script>
		<script>
			window.addEventListener("load", function (event) {
				if (anchors) {
					anchors.options.placement = 'left';
					anchors.add();
				}
			});
		</script><!-- Search Dialog -->
<div
	class="modal fade"
	id="mkdocs_search_modal"
	tabindex="-1"
	role="dialog"
	aria-labelledby="searchModalLabel"
	aria-hidden="true"
>
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content bg-body">
			<div class="modal-header">
				<h4 class="modal-title"
						id="searchModalLabel">Search</h4>
				<button
					type="button"
					class="btn-close"
					data-bs-dismiss="modal"
					aria-label="Close"
				>
				</button>
			</div>
			<div class="modal-body">
				<p>From here you can search these documents. Enter your search terms below.</p>
				<form>
					<div class="form-group">
						<input
							type="search"
							class="form-control"
							placeholder="Search..."
							id="mkdocs-search-query"
							title="Type search term here"
						>
					</div>
				</form>
				<div
						id="mkdocs-search-results"
						data-no-results-text="No results found">
				</div>
			</div>
			<div class="modal-footer"></div>
		</div>
	</div>
</div><!-- Keyboard Dialog -->
				<div
						class="modal"
						id="mkdocs_keyboard_modal"
						tabindex="-1"
						role="dialog"
						aria-labelledby="keyboardModalLabel"
						aria-hidden="true"
				>
						<div class="modal-dialog">
								<div class="modal-content">
										<div class="modal-header">
												<h4 class="modal-title"
														id="keyboardModalLabel">Keyboard Shortcuts</h4>
												<button
														type="button"
														class="close"
														data-dismiss="modal"
												>
														<span aria-hidden="true">&times;</span>
														<span class="visually-hidden">Close</span>
												</button>
										</div>
										<div class="modal-body">
										<table class="table">
												<thead>
												<tr>
														<th style="width: 20%;">Keys</th>
														<th>Action</th>
												</tr>
												</thead>
												<tbody>
												<tr>
														<td class="help shortcut"><kbd>?</kbd></td>
														<td>Open this help</td>
												</tr>
												<tr>
														<td class="next shortcut"><kbd>n</kbd></td>
														<td>Next page</td>
												</tr>
												<tr>
														<td class="prev shortcut"><kbd>p</kbd></td>
														<td>Previous page</td>
												</tr>
												<tr>
														<td class="search shortcut"><kbd>s</kbd></td>
														<td>Search</td>
												</tr>
												</tbody>
										</table>
										</div>
										<div class="modal-footer">
										</div>
								</div>
						</div>
				</div>
	</body>
</html>