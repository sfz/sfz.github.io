<!DOCTYPE html>
<html
	lang="en"
	data-bs-theme="auto"
>
	<head>
		<meta charset="utf-8">
		<meta name="author" content="Karoryfer Samples and SFZ Format Team">
		<meta name="web-author" content="redtide and SFZ Format Team">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
		<title>Legato - SFZ Format</title>
	
		<script src="../../assets/js/color-modes.js"></script>
		<link href="../../atom.xml" rel="alternate" title="News" type="application/atom+xml" />

		
		<!-- realfavicongenerator.net -->
		<link rel="apple-touch-icon" sizes="152x152" href="../../assets/ico/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="../../assets/ico/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="../../assets/ico/favicon-16x16.png">
		<link rel="manifest" href="../../assets/ico/site.webmanifest">
		<link rel="mask-icon" href="../../assets/ico/safari-pinned-tab.svg" color="#5bbad5">
		<link rel="shortcut icon" href="../../assets/ico/favicon.ico">
		<meta name="msapplication-TileColor" content="#da532c">
		<meta name="msapplication-config" content="../../assets/ico/browserconfig.xml">
		<meta name="theme-color" content="#ffffff">
		<link href="../../assets/css/style.min.css" rel="stylesheet" media="screen">
		<link href="../../../../assets/css/fontawesome.min.css" rel="stylesheet">
		<link href="../../../../assets/css/brands.min.css" rel="stylesheet">
		<link href="../../../../assets/css/solid.min.css" rel="stylesheet">
		<link href="../../../../assets/css/v4-font-face.min.css" rel="stylesheet">
		<link href="../../../../assets/css/bootstrap-table.min.css" rel="stylesheet">		<link
			rel="stylesheet"
			href="../../assets/css/github.min.css"
			disabled="disabled"
			id="hljs_light"
		/>
		<link
			rel="stylesheet"
			href="../../assets/css/github-dark-dimmed.min.css"
			disabled="disabled"
			id="hljs_dark"
		/>
	</head>
	<body>
		<button onclick="topFunction()" id="scrollButton" title="Go to top">Top</button>
		<div class="container">			<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  		<!--!
				Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License
				https://fontawesome.com/license/free
				(Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
				Copyright 2023 Fonticons, Inc.
			-->
				<symbol id="sun" viewBox="0 0 512 512">
					<path d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z" />
				</symbol>
				<symbol id="moon" viewBox="0 0 384 512">
					<path d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z" />
				</symbol>
				<symbol id="circle-half-stroke" viewBox="0 0 512 512">
					<path d="M448 256c0-106-86-192-192-192V448c106 0 192-86 192-192zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z" />
				</symbol>
				<symbol id="check" viewBox="0 0 448 512">
					<path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z" />
				</symbol>
			</svg>
			<nav
				class="navbar navbar-expand-lg bg-dark text-bg-dark"
				data-bs-theme="dark"
			>
				<div class="container-fluid">

					<button
						class="navbar-toggler"
						type="button"
						data-bs-toggle="collapse"
						data-bs-target="#navbarContent"
						aria-controls="navbarContent"
						aria-expanded="false"
						aria-label="Toggle navigation"
					>
						<span class="navbar-toggler-icon"></span>
					</button>

					<a
						class="navbar-brand"
						href="../.."
						>
							<img
								alt="Logo image"
								src="../../assets/img/logo.svg"
							/>
					</a>

					<div class="collapse navbar-collapse" id="navbarContent">
						<ul class="navbar-nav mt-2 mt-lg-0">
							<li class="nav-item dropdown">
								<a
									class="nav-link dropdown-toggle"
									href="#"
									id="navbarSyntax"
									role="button"
									data-bs-toggle="dropdown"
									aria-expanded="false"
									aria-haspopup="true"
								>
									Syntax
								</a>
								<ul
									class="dropdown-menu"
									aria-labelledby="navbarSyntax"
								>
									<li>
										<a class="dropdown-item"
											href="/headers/"
										>
											Headers
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/opcodes/"
										>
											Opcodes
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/modulations/"
										>
											Modulations
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/modulations/envelope_generators"
										>
											Envelope Generators
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/modulations/lfo"
										>
											LFO
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/extensions/midi_ccs"
										>
											Extended MIDI CCs
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/misc/categories"
										>
											Types & Categories
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/versions"
										>
											Versions
										</a>
									</li>
								</ul>
							</li>
							<li class="nav-item dropdown">
								<a
									class="nav-link dropdown-toggle"
									href="#"
									id="navbarSoftware"
									role="button"
									data-bs-toggle="dropdown"
									aria-expanded="false"
									aria-haspopup="true"
								>
									Software
								</a>
								<ul
									class="dropdown-menu"
									aria-labelledby="navbarSoftware"
								>
									<li>
										<a class="dropdown-item"
											href="/software/players"
										>
											Players
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/software/tools"
										>
											Tools
										</a>
									</li>
								</ul>
							</li>
							<li class="nav-item dropdown">
								<a
									class="nav-link dropdown-toggle"
									href="#"
									id="navbarTutorials"
									role="button"
									data-bs-toggle="dropdown"
									aria-expanded="false"
									aria-haspopup="true"
								>
									Tutorials
								</a>
								<ul
									class="dropdown-menu"
									aria-labelledby="navbarTutorials"
								>
									<li>
										<a class="dropdown-item"
											href="/tutorials/basics"
										>
											Basics
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/tutorials/basic_sfz_file"
										>
											Basic / Template
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/sustained_note_basics"
										>
											Sustained Note Basics
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/vibrato"
										>
											Vibrato
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/legato"
										>
											Legato
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/unison"
										>
											Unison
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/range_extension"
										>
											Range Extension
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/modular_instruments"
										>
											Modular Instruments
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/subtractive_synths"
										>
											Subtractive Synthesizers
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/strum"
										>
											Strumming
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/tutorials/drum_basics"
										>
											Drum & Round Robin Basics
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/cymbal_muting"
										>
											Cymbal Muting
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/epic_drums"
										>
											Epic Drums
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/brush_stirs"
										>
											Brush Stirs
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/tutorials/envelope_generators"
										>
											Envelope Generators
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/sfz1_modulations"
										>
											SFZ 1 Modulations
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/sfz2_modulations"
										>
											SFZ 2 Modulations
										</a>
									</li>
									<li>
										<a class="dropdown-item"
											href="/tutorials/lfo"
										>
											Pitch LFO Examples
										</a>
									</li>
									<div class="dropdown-divider"></div>
									<li>
										<a class="dropdown-item"
											href="/tutorials/videos"
										>
											Video Tutorials
										</a>
									</li>
								</ul>
							</li>
							<li class="nav-item">
								<a
									class="nav-link"
									href="https://sfzinstruments.github.io"
								>
									Instruments
								</a>
							</li>
							<li class="nav-item">
								<a
									class="nav-link"
									href="/news"
								>
									News
								</a>
							</li>
						</ul>
						<ul class="navbar-nav ms-auto">
							<li class="nav-item">
									<a
										href="#"
										class="nav-link"
										data-bs-toggle="modal"
										data-bs-target="#mkdocs_search_modal">
											<i class="fa fa-search"></i> Search
									</a>
							</li>
							<li class="nav-item dropdown">
								<button
									class="btn btn-link nav-link py-2 px-0 px-lg-2 dropdown-toggle d-flex align-items-center"
									id="bd-theme"
									type="button"
									aria-expanded="false"
									data-bs-toggle="dropdown"
									data-bs-display="static"
									aria-label="Toggle theme (auto)">
									<svg class="bi my-1 theme-icon-active"><use href="#circle-half-stroke"></use></svg>
									<span class="d-lg-none ms-2" id="bd-theme-text">Toggle theme</span>
								</button>
								<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
									<li>
										<button
											type="button"
											class="dropdown-item d-flex align-items-center"
											data-bs-theme-value="light"
											aria-pressed="false">
											<svg class="bi me-2 opacity-50 theme-icon"><use href="#sun"></use></svg>
											Light
											<svg class="bi ms-auto d-none"><use href="#check"></use></svg>
										</button>
									</li>
									<li>
										<button
											type="button"
											class="dropdown-item d-flex align-items-center"
											data-bs-theme-value="dark"
											aria-pressed="false">
											<svg class="bi me-2 opacity-50 theme-icon"><use href="#moon"></use></svg>
											Dark
											<svg class="bi ms-auto d-none"><use href="#check"></use></svg>
										</button>
									</li>
									<li>
										<button
											type="button"
											class="dropdown-item d-flex align-items-center active"
											data-bs-theme-value="auto"
											aria-pressed="true">
											<svg class="bi me-2 opacity-50 theme-icon"><use href="#circle-half-stroke"></use></svg>
											Auto
											<svg class="bi ms-auto d-none"><use href="#check"></use></svg>
										</button>
									</li>
								</ul>
							</li>
						</ul>
					</div>
				</div>
			</nav>
			<div class="row mt-4" id="content">
				<div class="col-md-9">
					<article>
						<h1>Legato</h1><h2 id="basic-monophony">Basic monophony</h2>
<p>In the basic sustained instruments
tutorial, we have the below example of a monophonic flute, which uses the
<a href="../../opcodes/group/">group</a> and <a href="../../opcodes/off_by/">off_by</a> opcodes to allow only one be played at a time,
and the <a href="../../opcodes/off_mode/">off_mode</a> together with <a href="../../opcodes/ampeg_release/">ampeg_release</a> make the fadeout of the previous
note a little smoother. This is a starting point for implementing legato.</p>
<p>If only group and off_by are specified, the resulting sound will probably be quite bad, as
this will use default values for off_mode, ampeg_attack and ampeg_release. This means the note being
muted will drop off extremely quickly, which will probably leave an audible drop in levels during the
transition, unless the next note has an extremely fast attack. Therefore, at least ampeg_release
will need to be specified in most cases - though most instruments will need to specify that even
if not using legato.</p>
<pre><code class="language-sfz">&lt;global&gt;ampeg_release=0.3 amp_veltrack=0 sw_lokey=48 sw_hikey=49

group=1 off_by=1 off_mode=normal
&lt;group&gt;lokey=50 hikey=51 pitch_keycenter=50 sw_last=48
&lt;region&gt;sample=d4_p.wav xfin_locc1=0 xfin_hicc1=42 xfout_locc1=43 xfout_hicc1=85
&lt;region&gt;sample=d4_mf.wav xfin_locc1=43 xfin_hicc1=85 xfout_locc1=86 xfout_hicc1=127
&lt;region&gt;sample=d4_f.wav xfin_locc1=86 xfin_hicc1=127
&lt;group&gt;lokey=52 hikey=53 pitch_keycenter=52 sw_last=48
&lt;region&gt;sample=e4_p.wav xfin_locc1=0 xfin_hicc1=42 xfout_locc1=43 xfout_hicc1=85
&lt;region&gt;sample=e4_mf.wav xfin_locc1=43 xfin_hicc1=85 xfout_locc1=86 xfout_hicc1=127
&lt;region&gt;sample=e4_f.wav xfin_locc1=86 xfin_hicc1=127
&lt;group&gt;lokey=50 hikey=51 pitch_keycenter=50 sw_last=49
&lt;region&gt;sample=d4_ft_p.wav xfin_locc1=0 xfin_hicc1=63 xfout_locc1=64 xfout_hicc1=127
&lt;region&gt;sample=d4_ft_f.wav xfin_locc1=64 xfin_hicc1=127
&lt;group&gt;lokey=52 hikey=53 pitch_keycenter=52 sw_last=49
&lt;region&gt;sample=e4_ft_p.wav xfin_locc1=0 xfin_hicc1=63 xfout_locc1=64 xfout_hicc1=127
&lt;region&gt;sample=e4_ft_f.wav xfin_locc1=64 xfin_hicc1=127
</code></pre>
<h2 id="legato-regions">Legato regions</h2>
<p>The above will allow only one note to sound at a time, with a quick crossfade between
the old and new note. In many cases, though, it makes sense to treat the legato notes
differently than the notes which start a phrase when no other note is playing. The
<a href="../../opcodes/trigger/">trigger</a> opcode is used to separate regions into initial and legato. For
sustained sounds, it can make sense to use the <a href="../../opcodes/offset/">offset</a> opcode to skip the start
of the sample for legato regions. It's also probably a good idea to use offset_attack
in these cases, which both makes the transition sound smoother and avoids clicks and
pops in cases where the offset does not fall on a zero crossing. Here are the relevant
opcodes from the Hadziha choir.</p>
<p>An offset of 6000 samples is enough to skip the fraction of a second when the singers
are starting the note, but not enough to skip the part of the sample when they're still
settling on a common pitch, so it works well for this particular choir. The crossfade
times with an off time of 1 second and legato note attack time of 0.4 seconds are
probably much longer than would be needed for most solo instruments or voices, or
ensembles intended for fast legato, but could be a good range for other types of
ensembles playing slowly.</p>
<p>Note that the samples are not all in the same group - the initial note regions are in
polyphony group 1, which is muted by group 2. The legato regions are in polyphony
group 2, which mutes itself. Having everything in group 1 should also work, though.
This was done this was to allow the use of additional syllable start samples, which
would then be group 3 and also be muted by group 2. As with hi-hat muting, if there
are multiple mic positions in separate files, each mic position will need its own
polyphony groups.</p>
<pre><code class="language-sfz">&lt;global&gt;off_mode=time
off_time=1
amp_veltrack=0

&lt;master&gt;trigger=first
group=1
off_by=2
//Sample map goes here
#include &quot;mappings/6_a_map.sfz&quot;

&lt;master&gt;trigger=legato
offset=6000
ampeg_attack=0.4
group=2
off_by=2
//Sample map goes here
#include &quot;mappings/6_a_map.sfz&quot;
</code></pre>
<p>As this does not use velocity to control note volume, that frees up velocity for
something else, so in this specific case velocity is repurposed to shorten the
attack time on the legato notes, which makes the patch more intuitively playable.</p>
<pre><code class="language-sfz">&lt;global&gt;off_mode=time
off_time=1
amp_veltrack=0

&lt;master&gt;trigger=first
group=1
off_by=3
//Sample map goes here
#include &quot;mappings/6_a_map.sfz&quot;

&lt;master&gt;trigger=legato
offset=6000
ampeg_attack=1
ampeg_vel2attack=-0.8
group=3
off_by=3
//Sample map goes here
#include &quot;mappings/6_a_map.sfz&quot;
</code></pre>
<h2 id="portamento">Portamento</h2>
<p>Another possibility is portamento, or having a pitch glide implemented on the
legato regions. Here are the relevant opcodes from Karoryfer Samples
Meatbass, which has both legato and portamento. The portamento is
very obviously fake for slow glides across long intervals, but as long as the
interval is no more than a third or fourth, it can be convincing. Of course, the
narrower the interval and the shorter the time, the easier it is to sound
convincing. With the portamento time at zero, this is effectively the same as
non-portamento legato in the above example.</p>
<p>In the below setup, MIDI CC109 controls the glide time and an SFZ2 <a href="../../modulations/envelope_generators/">envelope</a>
is used to make the pitch change happen. CC140 is the ARIA extension CC for pitch
delta, and being the difference in pitch between the previous note and the
current note, it sets the depth of the glide envelope.</p>
<pre><code class="language-sfz">&lt;global&gt;eg06_sustain=1 //Pitch envelope setup for legato slides
eg06_level0=-1 //Envelope starts away from the note pitch
eg06_time0=0
eg06_pitch_oncc140=100 //This is the pitch depth
eg06_time1=0
eg06_level1=0 //At the end of the envelope, return to base pitch
//eg06_time1_oncc109 needs to be set for the legato regions - but we don't want
//it on for all regions so the default is 0
//At zero envelope duration the pitch goes to base pitch immediately so there
//is no glide

//Typical stuff for monophonic instruments
off_mode=normal
ampeg_release_oncc104=2
</code></pre>
<p>All the sample regions are then basically duplicated in non-legato and legato
versions. Here's an example non-legato region with trigger
set to first and no eg06_time_oncc109 set. The group and off_by work just like
in the above examples.</p>
<pre><code class="language-sfz">&lt;group&gt;
trigger=first
off_mode=normal
group=1
off_by=1

&lt;region&gt;
sample=..\Samples\arco_looped\c4_sustain.wav
pitch_keycenter=48
</code></pre>
<p>And the corresponding legato region with trigger set to legato, the eg06 glide
envelope time control, and also an attack time, to let the note fade in
more gradually, with this controlled by CC100 rather than velocity, as the
example above. This is another option.</p>
<pre><code class="language-sfz">&lt;group&gt;
trigger=legato
off_mode=normal
group=1
off_by=1
eg06_time1_oncc109=0.3
ampeg_attack_oncc100=0.5

&lt;region&gt;
sample=..\Samples\arco_looped\c4_sustain.wav
pitch_keycenter=48
</code></pre>
<h2 id="true-sampled-legato">True sampled legato</h2>
<p>Here are examples from a simple flute test by MatFluor. The trigger=first regions
work similarly as all the above examples, and the <a href="../../opcodes/sw_previous/">sw_previous</a> opcode can be used
to choose which sample plays for the legato regions. If the samples would include
both the legato transition and the complete sustain of the following note, things
would be very simple:</p>
<pre><code class="language-sfz">&lt;group&gt;
// Legato transitions and the complete sustain of the next note both in the same sample
trigger=legato
group=2
off_by=1
ampeg_attack=0.05 ampeg_release=0.2
off_mode=normal

// Leg transitions up
&lt;region&gt; sample=legatovib_g4_a4.wav key=A4 sw_previous=G4
&lt;region&gt; sample=legatovib_g4_c5.wav key=C5 sw_previous=G4
&lt;region&gt; sample=legatovib_a4_c5.wav key=C5 sw_previous=A4
// Leg transitions down
&lt;region&gt; sample=legatovib_c5_a4.wav key=A4 sw_previous=C5
&lt;region&gt; sample=legatovib_c5_g4.wav key=G4 sw_previous=C5
</code></pre>
<p>Recording the full sustain after every transition adds greatly to the recording
time, diskspace and RAM use, however. It may be necessary in some cases, such as
solo vocals, but in other cases it's possible to use transition samples which
are short, then fade in the regular sustain sample.</p>
<pre><code class="language-sfz">&lt;group&gt;
// Legato transitions in one sample, crossfaded into standard sustain in another sample
trigger=legato
group=2
off_by=1
ampeg_attack=0.05 ampeg_release=0.2
off_mode=normal

// Leg transitions up
&lt;region&gt; sample=legatovib_g4_a4.wav key=A4 sw_previous=G4 ampeg_hold=0.25 ampeg_decay=0.2 ampeg_sustain=0 offset=45000 ampeg_decay_shape=-1.4
&lt;region&gt; sample=legatovib_g4_c5.wav key=C5 sw_previous=G4 ampeg_hold=0.25 ampeg_decay=0.2 ampeg_sustain=0 offset=45000 ampeg_decay_shape=-1.4
&lt;region&gt; sample=legatovib_a4_c5.wav key=C5 sw_previous=A4 ampeg_hold=0.25 ampeg_decay=0.2 ampeg_sustain=0 offset=45000 ampeg_decay_shape=-1.4
// Leg transitions down
&lt;region&gt; sample=legatovib_c5_a4.wav key=A4 sw_previous=C5 ampeg_hold=0.25 ampeg_decay=0.2 ampeg_sustain=0 offset=45000 ampeg_decay_shape=-1.4
&lt;region&gt; sample=legatovib_c5_g4.wav key=G4 sw_previous=C5 ampeg_hold=0.25 ampeg_decay=0.2 ampeg_sustain=0 offset=45000 ampeg_decay_shape=-1.4
&lt;region&gt; sample=legatovib_a4_g4.wav key=G4 sw_previous=A4 ampeg_hold=0.25 ampeg_decay=0.2 ampeg_sustain=0 offset=43000 ampeg_decay_shape=-1.4
// Leg sustains
&lt;region&gt; sample=sustainvib_c5.wav key=C5 ampeg_attack=0.3 offset=5000 ampeg_attack_shape=3.8
&lt;region&gt; sample=sustainvib_a4.wav key=A4 ampeg_attack=0.3 offset=5000 ampeg_attack_shape=3.8
&lt;region&gt; sample=sustainvib_g4.wav key=G4 ampeg_attack=0.3 offset=5000 ampeg_attack_shape=3.8
</code></pre>
<p>Another consideration is that for instruments with a wide range, it may not be worthwhile
to record every possible transition, and only record transitions of up to one octave, for
example. The <a href="../../extensions/midi_ccs/">extended CCs</a> do not always behave quite like other CCs,
necessitating using hdcc in ARIA, but the below works for a legato vocal with a range of
less than two octaves.</p>
<pre><code class="language-sfz">&lt;global&gt;
off_mode=time
off_time=0.4
ampeg_release=0.3

&lt;group&gt;
trigger=first
group=1
off_by=1
#include &quot;modules/vowel_sustain_a.sfz&quot;

&lt;group&gt;
trigger=legato
group=1
off_by=1
ampeg_attack=0.1
ampeg_hold=0.3
ampeg_decay=0.6
ampeg_sustain=0
hihdcc141=12.1
#include &quot;modules/vowel_transition_a.sfz&quot;

&lt;group&gt;
trigger=legato
group=2
off_by=1
delay=0.3
ampeg_attack=0.2
offset=40000
hihdcc141=12.1
#include &quot;modules/vowel_sustain_a.sfz&quot;

&lt;group&gt;
trigger=legato
group=1
off_by=1
ampeg_attack=0.1
lohdcc141=12.9
hihdcc141=24
offset=12000
#include &quot;modules/vowel_sustain_a.sfz&quot;
</code></pre>
<p>It is also possible to use CC 140 in a similar way in an instrument which,
for example, has legato transitions recorded ascending but not descending.</p>
<h2 id="further-true-legato-possibilities">Further True Legato Possibilities</h2>
<p>It's possible to make a legato instrument that's not sampled chromatically. In
such cases, it's necessary to use the same tricks used when <a href="../range_extension/">extending</a> range and
transpose samples across a wider range. The important thing to remember is that
when extending the range of a sample, lokey, hikey and sw_previous all need to
be changed by the same amount from the original. For example, if an instrument
has transitions sampled from C and D but not from C#, like this:</p>
<pre><code>&lt;region&gt; sample=legatovib_c5_a4.wav key=A4 sw_previous=C5
&lt;region&gt; sample=legatovib_c5_a#4.wav key=A#4 sw_previous=C5
&lt;region&gt; sample=legatovib_c5_b4.wav key=B4 sw_previous=C5
&lt;region&gt; sample=legatovib_d5_a4.wav key=A4 sw_previous=D5
&lt;region&gt; sample=legatovib_d5_a#4.wav key=A#4 sw_previous=D5
&lt;region&gt; sample=legatovib_d5_b4.wav key=B4 sw_previous=D5
</code></pre>
<p>Extending the transitions from C5 to be used as transitions from C#5 for those same
three notes could look like this:</p>
<pre><code>&lt;region&gt; sample=legatovib_c5_a4.wav key=A4 sw_previous=C5
&lt;region&gt; sample=legatovib_c5_a#4.wav key=A#4 sw_previous=C5
&lt;region&gt; sample=legatovib_c5_b4.wav key=B4 sw_previous=C5
&lt;region&gt; sample=legatovib_c5_g#4.wav lokey=A4 hikey=A4 pitch_keycenter=G#4 sw_previous=C#5
&lt;region&gt; sample=legatovib_c5_a4.wav lokey=A#4 hikey=A#4 pitch_keycenter=A4 sw_previous=C#5
&lt;region&gt; sample=legatovib_c5_a#4.wav lokey=B4 hikey=B4 pitch_keycenter=A#4 sw_previous=C#5
&lt;region&gt; sample=legatovib_d5_a4.wav key=A4 sw_previous=D5
&lt;region&gt; sample=legatovib_d5_a#4.wav key=A#4 sw_previous=D5
&lt;region&gt; sample=legatovib_d5_b4.wav key=B4 sw_previous=D5
</code></pre>
<p>In one real-world case where the notes from which the intervals were sampled was not
completely consistent between different dynamic layers, the easiest way to deal with this
was to copy the entire sample map, move the lokey, hikey and sw_previous values by one
in the copy, then manually delete the duplicates and values where either the key or
sw_previous falls outside the instrument's range.</p>
<p>An instrument which does not have all interval transitions sampled, however, would be more
tricky. For example, a diatonic folk flute in C would not have a minor second from C to C#,
and the nearest available minor second transition would be from E to F, which would be a
pretty big transposition. One possible compromise in such cases would probably be to use
the C to D transition transposed down a minor second, which would include a bit of B at
the start of the transition, but if the transitions are quick enough this might be
passable. A better but more laborious solution would be processing the recordings with
pitch transposition software such as Melodyne or Zplane reTune to create the missing
intervals.</p>
					</article>
				</div>
				<div class="col-md-3">
					<aside>
						<div class="card mb-3">
							<div class="card-header bg-dark text-bg-dark">
								<i class="fa fa-eye"
									aria-hidden="true"></i>
								Follow us
							</div>
							<div class="card-body" style="padding: 0.5rem">
								<ul class="nav nav-pills flex-column">
									<li class="nav-item">
										<a class="nav-link" href="https://github.com/sfz/"
											title="GitHub Organization" style="padding: 0.35rem 0.25rem">
										<i class="fab fa-github fa-fw"
										aria-hidden="true"></i>
										GitHub Organization</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="/atom.xml"
											title="News Atom Feed" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-rss fa-fw"
										aria-hidden="true"></i>
										News Atom Feed</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://discord.gg/t7nrZ6d"
											title="Discord Chat" style="padding: 0.35rem 0.25rem">
										<i class="fab fa-discord fa-fw"
										aria-hidden="true"></i>
										Discord Chat</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://kiwiirc.com/nextclient/#irc://irc.libera.chat:+6697/#sfzformat"
											title="Internet Relay Chat" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-hashtag fa-fw"
										aria-hidden="true"></i>
										IRC</a>
									</li>
								</ul>
							</div>
						</div>
						<div class="card mb-3">
							<div class="card-header bg-dark text-bg-dark">
								<i class="fa fa-link"
									aria-hidden="true"></i>
								Quick links
							</div>
							<div class="card-body" style="padding: 0.5rem">
								<ul class="nav nav-pills flex-column">
									<li class="nav-item">
										<a class="nav-link" href="/legacy"
											title="Old rgc:audio SFZ page" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-book fa-fw"
										aria-hidden="true"></i>
										Old rgc:audio SFZ page</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="http://www.drealm.info/sfz/"
											title="Peter L. Jones' SFZ page" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-book fa-fw"
										aria-hidden="true"></i>
										Peter L. Jones' SFZ page</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://www.kvraudio.com/forum/viewtopic.php?f=42&t=508861"
											title="KVR Forum SFZ post" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-users fa-fw"
										aria-hidden="true"></i>
										KVR Forum SFZ post</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://www.plogue.com/plgfrms/viewforum.php?f=14"
											title="Plogue Forum" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-users fa-fw"
										aria-hidden="true"></i>
										Plogue Forum</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://github.com/sfz/tests/"
											title="rgc:audio SFZ test suite" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-download fa-fw"
										aria-hidden="true"></i>
										rgc:audio SFZ test suite</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" href="https://github.com/sfz/opcode-suggestions/"
											title="Opcode suggestions" style="padding: 0.35rem 0.25rem">
										<i class="fa fa-lightbulb fa-fw"
										aria-hidden="true"></i>
										Opcode suggestions</a>
									</li>
								</ul>
							</div>
						</div>
						
					</aside>
				</div>
			</div>			<hr>
			<footer>
				<p style="text-align:left">
					<span style="float:right">
						This site is open source.
						<a href="https://github.com/sfz/sfz.github.io/edit/source/docs/tutorials/legato.md">
						Improve this page</a>
					</span>
				</p>
			</footer>
		</div>		<script>
			var base_url	= "../..",
					shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
		</script>
		<script src="../../assets/js/jquery.min.js"></script>
		<script async defer src="../../assets/js/popper.min.js"></script>
		<script async defer src="../../assets/js/bootstrap.min.js"></script>
		<script async defer src="../../assets/js/anchor.min.js"></script>
		<script async defer src="../../assets/js/base.min.js"></script>
		<script async defer src="../../assets/js/scroll-to-top.min.js"></script>
		<script async defer src="../../../../assets/js/index.bundle.min.js"></script>
		<script async defer src="../../../../assets/js/bootstrap-table.min.js"></script>
		<script async defer src="../../../../assets/js/mermaid.min.js"></script>
		<script async defer src="../../../../search/main.js"></script>		<script
			type="text/javascript"
			src="../../assets/js/highlight.min.js">
		</script>
		<script
			type="text/javascript"
			src="../../assets/js/bash.min.js">
		</script>
		<script
			type="text/javascript"
			src="../../assets/js/cpp.min.js">
		</script>
		<script
			type="text/javascript"
			src="../../assets/js/sfz.min.js">
		</script>
		<script>hljs.highlightAll();</script>
		<script>
			window.addEventListener("load", function (event) {
				if (anchors) {
					anchors.options.placement = 'left';
					anchors.add();
				}
			});
		</script><!-- Search Dialog -->
<div
	class="modal fade"
	id="mkdocs_search_modal"
	tabindex="-1"
	role="dialog"
	aria-labelledby="searchModalLabel"
	aria-hidden="true"
>
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content bg-body">
			<div class="modal-header">
				<h4 class="modal-title"
						id="searchModalLabel">Search</h4>
				<button
					type="button"
					class="btn-close"
					data-bs-dismiss="modal"
					aria-label="Close"
				>
				</button>
			</div>
			<div class="modal-body">
				<p>From here you can search these documents. Enter your search terms below.</p>
				<form>
					<div class="form-group">
						<input
							type="search"
							class="form-control"
							placeholder="Search..."
							id="mkdocs-search-query"
							title="Type search term here"
						>
					</div>
				</form>
				<div
						id="mkdocs-search-results"
						data-no-results-text="No results found">
				</div>
			</div>
			<div class="modal-footer"></div>
		</div>
	</div>
</div><!-- Keyboard Dialog -->
				<div
						class="modal"
						id="mkdocs_keyboard_modal"
						tabindex="-1"
						role="dialog"
						aria-labelledby="keyboardModalLabel"
						aria-hidden="true"
				>
						<div class="modal-dialog">
								<div class="modal-content">
										<div class="modal-header">
												<h4 class="modal-title"
														id="keyboardModalLabel">Keyboard Shortcuts</h4>
												<button
														type="button"
														class="close"
														data-dismiss="modal"
												>
														<span aria-hidden="true">&times;</span>
														<span class="visually-hidden">Close</span>
												</button>
										</div>
										<div class="modal-body">
										<table class="table">
												<thead>
												<tr>
														<th style="width: 20%;">Keys</th>
														<th>Action</th>
												</tr>
												</thead>
												<tbody>
												<tr>
														<td class="help shortcut"><kbd>?</kbd></td>
														<td>Open this help</td>
												</tr>
												<tr>
														<td class="next shortcut"><kbd>n</kbd></td>
														<td>Next page</td>
												</tr>
												<tr>
														<td class="prev shortcut"><kbd>p</kbd></td>
														<td>Previous page</td>
												</tr>
												<tr>
														<td class="search shortcut"><kbd>s</kbd></td>
														<td>Search</td>
												</tr>
												</tbody>
										</table>
										</div>
										<div class="modal-footer">
										</div>
								</div>
						</div>
				</div>
	</body>
</html>